<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Latihan Project Sederhana</title>

  <meta name="supported-color-schemes" content="light dark">
  <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="#0b1220" media="(prefers-color-scheme: dark)">
  <meta id="theme-color-dynamic" name="theme-color" content="#ffffff">

  <style>
    *, *::before, *::after { box-sizing: border-box; }
    body { margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; }
    img, svg { display: block; max-width: 100%; height: auto; }
    button { font: inherit; }

    /* ====== Token warna (Light default) ====== */
    html {
      /* Beritahu browser soal skema warna form control */
      color-scheme: light;

      --page: #ffffff;
      --ink: #0b1220;
      --muted: #51607a;
      --border: #e2e8f0;
      --card: #f8fafc;
      --accent: #2563eb;            /* bisa diubah runtime */
      --radius: 14px;
      --space: clamp(.875rem, .7rem + 1vw, 1.25rem);
      --shadow: 0 10px 24px rgba(2,6,23,.08), 0 2px 8px rgba(2,6,23,.06);
    }

    @media (prefers-color-scheme: dark) {
      html {
        color-scheme: dark;
        --page: #0b1220;
        --ink: #e5ecff;
        --muted: #9fb0d0;
        --border: #1f2a44;
        --card: #0f172a;
      }
    }

    html[data-theme="light"] {
      color-scheme: light;
      --page: #ffffff; --ink:#0b1220; --muted:#51607a; --border:#e2e8f0; --card:#f8fafc;
    }
    html[data-theme="dark"] {
      color-scheme: dark;
      --page: #0b1220; --ink:#e5ecff; --muted:#9fb0d0; --border:#1f2a44; --card:#0f172a;
    }

    :root { accent-color: var(--accent); }

    body { background: var(--page); color: var(--ink); line-height: 1.6; }
    .wrap { width: min(100% - 2rem, 46rem); margin-inline: auto; padding-block: clamp(1rem, 3vw, 2rem); }

    header { display: grid; gap: .5rem; margin-bottom: var(--space); }
    h1 { margin: 0; font-size: clamp(1.4rem, 1.1rem + 1.2vw, 2rem); }
    .panel { display: grid; gap: .75rem; padding: var(--space); background: var(--card); border: 1px solid var(--border); border-radius: var(--radius); box-shadow: var(--shadow); }

    .controls { display: grid; gap: .5rem; }
    .row { display: flex; flex-wrap: wrap; gap: .5rem 1rem; align-items: center; }
    .seg { display: inline-grid; grid-auto-flow: column; gap: .25rem; background: var(--page); border: 1px solid var(--border); border-radius: 999px; padding: .25rem; }
    .seg input { display: none; }
    .seg label { padding: .4rem .75rem; border-radius: 999px; cursor: pointer; }
    .seg input:checked + label { background: var(--accent); color: white; }

    .swatches { display: inline-grid; grid-auto-flow: column; gap: .4rem; }
    .swatch { width: 28px; height: 28px; border-radius: 999px; border: 2px solid var(--border); cursor: pointer; }

    .todo { display: grid; gap: .75rem; margin-top: var(--space); }
    .todo form { display: grid; grid-template-columns: 1fr auto; gap: .5rem; }
    .todo input[type="text"] { padding: .65rem .8rem; border-radius: .75rem; border: 1px solid var(--border); background: var(--page); color: var(--ink); }
    .todo button.add { padding: .65rem .9rem; border-radius: .75rem; border: 1px solid var(--border); background: var(--page); }
    .todo button.add:hover { outline: 2px solid var(--accent); outline-offset: 2px; }
    ul.list { list-style: none; padding: 0; margin: 0; display: grid; gap: .5rem; }
    .item { display: grid; grid-template-columns: auto 1fr auto; align-items: center; gap: .5rem; padding: .6rem .7rem; border: 1px solid var(--border); border-radius: .75rem; background: var(--page); }
    .item.completed label { opacity: .6; text-decoration: line-through; }
    .item button { background: transparent; border: 0; padding: .25rem .4rem; border-radius: .5rem; }
    .item button:hover { background: color-mix(in oklab, var(--accent) 15%, transparent); }

    footer { margin-top: var(--space); font-size: .9rem; color: var(--muted); }
  </style>
</head>
<body>
  <main class="wrap">
    <header>
      <h1>Latihan Project Mini Todo</h1>
      <div class="panel controls" aria-label="Pengaturan tema">
        <div class="row">
          <strong>Mode:</strong>
          <div class="seg" role="tablist" aria-label="Pilih mode tema">
            <input type="radio" name="mode" id="m-system" value="system" checked>
            <label for="m-system">Sistem</label>
            <input type="radio" name="mode" id="m-light" value="light">
            <label for="m-light">Terang</label>
            <input type="radio" name="mode" id="m-dark" value="dark">
            <label for="m-dark">Gelap</label>
          </div>
        </div>
        <div class="row">
          <strong>Aksen:</strong>
          <div class="swatches" aria-label="Pilih warna aksen">
            <button class="swatch" style="background:#2563eb" data-accent="#2563eb" title="Biru"></button>
            <button class="swatch" style="background:#16a34a" data-accent="#16a34a" title="Hijau"></button>
            <button class="swatch" style="background:#ea580c" data-accent="#ea580c" title="Oranye"></button>
            <button class="swatch" style="background:#db2777" data-accent="#db2777" title="Magenta"></button>
            <button class="swatch" style="background:#7c3aed" data-accent="#7c3aed" title="Ungu"></button>
          </div>
        </div>
      </div>
    </header>

    <section class="panel todo" aria-labelledby="todo-title">
      <h2 id="todo-title" style="margin:0;font-size:1.1rem">Mini To‑Do</h2>
      <form id="todo-form" autocomplete="off">
        <input id="todo-input" type="text" placeholder="Tambah tugas…" aria-label="Tambah tugas">
        <button class="add" type="submit">Tambah</button>
      </form>
      <ul class="list" id="todo-list"></ul>
      <div class="row">
        <button id="clear-done" type="button">Hapus yang selesai</button>
        <span id="count" aria-live="polite" style="margin-left:auto"></span>
      </div>
    </section>

    <footer>
      <p>Project sederhana: adaptasi tema gelap/terang sesuai perangkat, ganti warna aksen, dan fitur To‑Do dasar (tersimpan lokal).</p>
    </footer>
  </main>

  <script>

    const $ = (sel, ctx=document) => ctx.querySelector(sel);
    const $$ = (sel, ctx=document) => Array.from(ctx.querySelectorAll(sel));


    const THEME_KEY = 'demo-theme-mode';
    const ACCENT_KEY = 'demo-accent';
    const themeMeta = $('#theme-color-dynamic');

    function applyMode(mode) {
      document.documentElement.removeAttribute('data-theme');
      if (mode === 'light' || mode === 'dark') {
        document.documentElement.setAttribute('data-theme', mode);
      }
      localStorage.setItem(THEME_KEY, mode);

      const isDark = getComputedStyle(document.documentElement).colorScheme === 'dark';
      themeMeta.content = isDark ? '#0b1220' : '#ffffff';
    }

    function applyAccent(color) {
      document.documentElement.style.setProperty('--accent', color);
      localStorage.setItem(ACCENT_KEY, color);
    }

    (function initTheme() {
      const savedMode = localStorage.getItem(THEME_KEY) || 'system';
      const savedAccent = localStorage.getItem(ACCENT_KEY) || getComputedStyle(document.documentElement).getPropertyValue('--accent').trim();
      applyMode(savedMode);
      applyAccent(savedAccent);
      // cekkan radio sesuai
      const input = document.querySelector(`input[name="mode"][value="${savedMode}"]`);
      if (input) input.checked = true;
    })();

    $$('.seg input[name="mode"]').forEach(r => {
      r.addEventListener('change', () => applyMode(r.value));
    });

    $$('.swatch').forEach(btn => btn.addEventListener('click', () => applyAccent(btn.dataset.accent)));

    const STORAGE = 'demo-todos-v1';
    const listEl = $('#todo-list');
    const formEl = $('#todo-form');
    const inputEl = $('#todo-input');
    const countEl = $('#count');

    function loadTodos() { try { return JSON.parse(localStorage.getItem(STORAGE)) || []; } catch { return []; } }
    function saveTodos(todos) { localStorage.setItem(STORAGE, JSON.stringify(todos)); }

    function render() {
      const todos = loadTodos();
      listEl.innerHTML = '';
      todos.forEach((t, i) => listEl.appendChild(renderItem(t, i)));
      const remaining = todos.filter(t => !t.done).length;
      countEl.textContent = remaining ? `${remaining} belum selesai` : 'Semua selesai';
    }

    function renderItem(t, index) {
      const li = document.createElement('li');
      li.className = 'item' + (t.done ? ' completed' : '');
      const cb = Object.assign(document.createElement('input'), { type: 'checkbox', checked: t.done, id: `todo-${index}` });
      const label = Object.assign(document.createElement('label'), { htmlFor: `todo-${index}`, textContent: t.text });
      const del = Object.assign(document.createElement('button'), { type: 'button', title: 'Hapus' });
      del.textContent = '✕';
      cb.addEventListener('change', () => { const todos = loadTodos(); todos[index].done = cb.checked; saveTodos(todos); render(); });
      del.addEventListener('click', () => { const todos = loadTodos(); todos.splice(index,1); saveTodos(todos); render(); });
      li.append(cb, label, del);
      return li;
    }

    formEl.addEventListener('submit', e => {
      e.preventDefault();
      const text = inputEl.value.trim();
      if (!text) return;
      const todos = loadTodos();
      todos.push({ text, done: false });
      saveTodos(todos);
      inputEl.value = '';
      render();
      inputEl.focus();
    });

    $('#clear-done').addEventListener('click', () => {
      const todos = loadTodos().filter(t => !t.done);
      saveTodos(todos);
      render();
    });

    render();
  </script>
</body>
</html>
